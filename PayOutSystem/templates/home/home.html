<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <title>NAU售后系统</title>
    <script src="../static/js/JQuery3.6.0.js"></script>
    <script>
        $(function () {
            // 设置path图像鼠标悬停效果
            var w = function (e) {
                $(this).find('path').attr('fill', 'white');
            }
            var b = function (e) {
                $(this).find('path').attr('fill', 'black');
            };
            var r = function (e) {
                $(this).find('path').attr('fill', 'red');
            };

            // 给左侧列表框绑定鼠标移入移出事件
            $('.icon').closest('div').bind({mouseenter: w, mouseleave: b});
            // 给顶部退出按钮绑定鼠标移入移出事件
            $('.exit_icon').closest('a').bind({mouseenter: r, mouseleave: w});

            //设置path图标颜色并解绑鼠标移除事件
            function is_active(obj) {
                obj = $(obj);
                obj.css({'background-color': '#fe7843', color: 'white'});
                obj.unbind('mouseenter').unbind('mouseleave');
                w.call(obj.get());
            }

            // 根据当前页面调整左侧列表样式
            var path = location.pathname;
            path = path.split('/')[1]
            if (path === 'home') {
                is_active($('#home').get());
            } else if (path == 'create_user') {
                is_active($('#add_users').get());
            } else if (path == 'goods' || path == 'check_goods') {
                is_active($('#goods_list').get());
            } else if (path == 'add_goods') {
                is_active($('#add_goods').get());
            } else if (path == 'all_users' || path == 'user_info') {
                is_active($('#users').get());
            } else if (path == 'me_info') {
                is_active($('#my_mess').get());
            }

            if (location.pathname === '/home/') {
                // ajax查询超时工单
                setTimeout(function () {
                    $.ajax({
                        url: '/search_timeout/',
                        type: 'GET',
                        dataType: 'json',
                        success: function (data) {
                            if (data.length > 0) {
                                $("#timeout_bg").prop('hidden', false);
                            }
                        }
                    });
                }, 1000);
            }
        });
    </script>

    <link rel="stylesheet" type="text/css" href="/static/css/home.css">
</head>
<body>

<div id="timeout_bg" hidden="true">
    <div id="timeout">
        <p>有已超时工单，请尽快处理！</p>
        <br/>
        <button id="timeout_ok" onclick="$('#timeout_bg').prop('hidden', true);">确定</button>
        <button id="timeout_look" onclick="location.href = '/goods?item=timeout#yichaoshi';$('#timeout_bg').prop('hidden', true);">前往查看</button>
    </div>
</div>

<!-- 顶部状态栏 -->
<div id="top">
    {% block top %}
        <p id="title">NAU售后系统</p>
        <div id="user_op">
            <!-- 用户 -->
            <a id="user" href="/me_info/{{ user.id }}">
                <img src="/media/{{ user.head_photo }}"/>
                {% if user.level == '0' %}
                    <span>管理员</span>
                {% elif user.level == '1' %}
                    <span>售后员</span>
                {% elif user.level == '2' %}
                    <span>申报员</span>
                {% endif %}
                <span>{{ user.name }}</span>
            </a>

            <!-- 退出登录 -->
            <script>
                function exit_user(e) {
                    if (confirm('确定退出当前账号吗?')) {
                        location.replace('/exit_user/')
                    }
                }
            </script>
            <a id="op" href="javascript:exit_user()" id="exit_user">
                <svg t="1645671495370" class="exit_icon" viewBox="0 0 1024 1024" version="1.1"
                     xmlns="http://www.w3.org/2000/svg" p-id="911" width="200" height="200">
                    <path
                            d="M695.893333 222.72c7.722667 0 14.848 2.730667 20.394667 7.338667l0.256-0.426667a384 384 0 1 1-411.008 1.237333l0.853333 1.066667a32 32 0 1 1 34.133334 52.565333l2.986666-1.92a320 320 0 1 0 337.834667 0.554667 32 32 0 0 1 14.506667-60.416z"
                            p-id="912" fill="#ffffff"></path>
                    <path
                            d="M480 85.333333m32 0l0 0q32 0 32 32l0 405.333334q0 32-32 32l0 0q-32 0-32-32l0-405.333334q0-32 32-32Z"
                            p-id="913" fill="#ffffff"></path>
                </svg>
                <span>退出</span>
            </a>

        </div>
        <div class="clear"></div>
    {% endblock top %}
</div>

<!-- 左侧列表 -->
<div id="left">
    {% block left %}
        <div>
            <a href="/home">
                <div class="item" id="home">
                    <span>
                        <svg t="1645980489230" class="icon" viewBox="0 0 1024 1024" version="1.1"
                             xmlns="http://www.w3.org/2000/svg" p-id="1070"
                             width="200" height="200"><path
                                d="M880.6912 457.1648l-282.7264-217.8048a133.53472 133.53472 0 0 0-164.4544 0.9728L158.8224 457.3184c-32.3072 25.4976-50.8416 63.744-50.8416 104.9088v232.3968c0 73.728 59.9552 133.6832 133.7344 133.6832h557.3632c73.728 0 133.6832-59.9552 133.6832-133.6832v-231.5264c0-41.216-19.456-80.7936-52.0704-105.9328z m-294.144 430.1824H427.3664v-175.9744c0-14.2848 11.6224-25.856 25.9072-25.856h107.4176c14.2848 0 25.9072 11.6224 25.9072 25.856v175.9744z m305.2544-92.7232c0 51.1488-41.6256 92.7232-92.7232 92.7232h-171.5712v-175.9744c0-36.864-30.0032-66.816-66.8672-66.816H453.2224c-36.864 0-66.8672 30.0032-66.8672 66.816v175.9744H241.7152c-51.1488 0-92.7744-41.6256-92.7744-92.7232v-232.3968c0-28.5696 12.8512-55.0912 35.2768-72.7552l274.6368-216.9344c16.8448-13.312 37.1712-20.0192 57.4976-20.0192a92.672 92.672 0 0 1 56.576 19.3024l282.7264 217.8048c22.6304 17.408 36.1472 44.9024 36.1472 73.472v231.5264z"
                                fill="#2c2c2c" p-id="1071"></path><path
                                d="M937.216 369.5616l-337.5104-240.896c-40.7552-31.3856-120.1152-40.0896-165.5808-4.864L87.7056 387.584a20.49024 20.49024 0 0 0-3.8912 28.7232 20.5568 20.5568 0 0 0 16.3328 8.0896c4.3008 0 8.704-1.3824 12.3904-4.1984l346.5728-263.8848c26.624-20.6336 86.1696-18.0224 115.8656 5.0176l0.6656 0.512 337.8176 241.1008c9.216 6.5536 22.016 4.4544 28.5696-4.7616 6.5024-9.2672 4.4032-22.016-4.8128-28.6208z"
                                fill="#2c2c2c" p-id="1072"></path>
                        </svg>
                        首页
                    </span>
                </div>
            </a>
            <a href="/goods">
                <div class="item" id="goods_list">
                    <span>
                        <svg t="1645980529585" class="icon" viewBox="0 0 1024 1024" version="1.1"
                             xmlns="http://www.w3.org/2000/svg" p-id="1265" width="200" height="200"><path
                                d="M723.9168 94.0032H300.9024c-84.7872 0-153.7536 68.9664-153.7536 153.7536v528.0256c0 84.7872 68.9664 153.7536 153.7536 153.7536h326.6048c13.6192 0 26.7264-3.84 38.0928-10.9568 0.9216-0.5632 1.792-1.2288 2.7136-1.8432 0.8704-0.6144 1.792-1.1776 2.6624-1.8432 1.7408-1.3312 3.4816-2.7648 5.12-4.2496l166.144-152.4224c22.4768-20.6336 35.3792-49.9712 35.3792-80.4864V247.7568c0.0512-84.7872-68.9152-153.7536-153.7024-153.7536zM188.1088 775.7312V247.7568c0-62.208 50.5856-112.7936 112.7936-112.7936h423.0144c62.208 0 112.7936 50.5856 112.7936 112.7936v409.4976h-117.5552c-51.4048 0-93.184 41.7792-93.184 93.184v138.1376H300.9024c-62.208 0-112.7936-50.6368-112.7936-112.8448z m478.8224 87.7568v-113.0496c0-28.7744 23.4496-52.224 52.224-52.224h114.3808c0 0.0512-0.0512 0.1024-0.0512 0.1536-0.8192 2.56-1.792 5.0688-2.9184 7.5264-0.3072 0.7168-0.6656 1.3824-1.024 2.048a72.54016 72.54016 0 0 1-4.3008 7.5264c-1.0752 1.5872-2.2016 3.1232-3.3792 4.608-0.512 0.6656-1.024 1.3312-1.5872 1.9968-1.792 2.048-3.6352 4.096-5.6832 5.9392l-147.6608 135.4752z"
                                fill="#2c2c2c" p-id="1266"></path><path
                                d="M326.2464 339.0976h366.4384c11.3152 0 20.48-9.1648 20.48-20.48s-9.1648-20.48-20.48-20.48H326.2464c-11.3152 0-20.48 9.1648-20.48 20.48s9.1648 20.48 20.48 20.48zM326.2464 535.1424h366.4384c11.3152 0 20.48-9.1648 20.48-20.48s-9.1648-20.48-20.48-20.48H326.2464c-11.3152 0-20.48 9.1648-20.48 20.48s9.1648 20.48 20.48 20.48zM470.4256 692.48H326.2464c-11.3152 0-20.48 9.1648-20.48 20.48s9.1648 20.48 20.48 20.48h144.1792c11.3152 0 20.48-9.1648 20.48-20.48s-9.1648-20.48-20.48-20.48z"
                                fill="#2c2c2c" p-id="1267"></path>
                        </svg>
                        查看工单
                    </span>
                </div>
            </a>
            <a href="/add_goods">
                <div class="item" id="add_goods">
                    <span>
                        <svg t="1645980573569" class="icon" viewBox="0 0 1024 1024" version="1.1"
                             xmlns="http://www.w3.org/2000/svg" p-id="1460" width="200" height="200"><path
                                d="M923.8528 388.7104c-19.8144-11.1104-43.264-10.6496-62.6176 1.1776l-42.1376 25.8048V208.2304c0-60.928-49.5616-110.5408-110.5408-110.5408H310.3232c-60.928 0-110.5408 49.5616-110.5408 110.5408v195.8912l-21.1968-13.2096c-19.3536-12.032-42.8544-12.6464-62.8736-1.5872s-31.8976 31.3344-31.8976 54.1696v321.2288c0 85.7088 69.7344 155.4432 155.4432 155.4432h560.7936c85.7088 0 155.4432-69.7344 155.4432-155.4432V442.7776c0.0512-22.7328-11.776-42.9568-31.6416-54.0672zM240.7424 208.2304c0-38.3488 31.232-69.5808 69.5808-69.5808h398.2336c38.3488 0 69.5808 31.232 69.5808 69.5808v232.4992L526.848 594.432a20.8896 20.8896 0 0 1-22.1184-0.1024L240.7424 429.7216V208.2304z m673.8432 556.544c0 63.1296-51.3536 114.4832-114.4832 114.4832H239.2576c-63.1296 0-114.4832-51.3536-114.4832-114.4832V443.5456c0-11.1616 7.5776-16.5888 10.8032-18.3808 1.8944-1.0752 5.632-2.7136 10.3424-2.7136 3.2768 0 7.0656 0.8192 10.9568 3.2768l326.144 203.4176a61.5936 61.5936 0 0 0 65.1264 0.256l334.3872-204.544c9.472-5.7856 18.0224-2.2016 21.248-0.4096 3.2256 1.792 10.752 7.2192 10.752 18.3296v321.9968z"
                                fill="#2c2c2c" p-id="1461"></path><path
                                d="M363.4688 268.4416h287.488c11.3152 0 20.48-9.1648 20.48-20.48s-9.1648-20.48-20.48-20.48H363.4688c-11.3152 0-20.48 9.1648-20.48 20.48s9.1648 20.48 20.48 20.48zM605.3888 364.288c0-11.3152-9.1648-20.48-20.48-20.48H365.6704c-11.3152 0-20.48 9.1648-20.48 20.48s9.1648 20.48 20.48 20.48h219.2384c11.3152 0 20.48-9.1648 20.48-20.48z"
                                fill="#2c2c2c" p-id="1462"></path>
                        </svg>
                        添加工单
                    </span>
                </div>
            </a>

            {% comment %}
                只有管理员有权限 查看 和 管理 用户
            {% endcomment %}
            {% if user.level == '0' %}
                <a href="/all_users">
                    <div class="item" id="users">
                        <span>
                            <svg t="1645981072998" class="icon" viewBox="0 0 1024 1024" version="1.1"
                                 xmlns="http://www.w3.org/2000/svg" p-id="3519" width="200" height="200"><path
                                    d="M776.192 146.0224H254.5152c-85.7088 0-155.4432 69.7344-155.4432 155.4432v420.6592c0 85.7088 69.7344 155.4432 155.4432 155.4432H776.192c85.7088 0 155.4432-69.7344 155.4432-155.4432V301.4656c0-85.7088-69.7344-155.4432-155.4432-155.4432z m114.4832 576.1024c0 63.1296-51.3536 114.4832-114.4832 114.4832H254.5152c-63.1296 0-114.4832-51.3536-114.4832-114.4832V301.4656c0-63.1296 51.3536-114.4832 114.4832-114.4832H776.192c63.1296 0 114.4832 51.3536 114.4832 114.4832v420.6592z"
                                    fill="#2c2c2c" p-id="3520"></path><path
                                    d="M463.104 494.9504c25.0368-20.224 41.1136-51.0976 41.1136-85.7088 0-60.7744-49.408-110.1824-110.1824-110.1824s-110.1824 49.408-110.1824 110.1824c0 34.4576 15.9232 65.28 40.8064 85.504-50.4832 25.3952-85.248 77.6704-85.248 137.9328v44.5952c0 25.2416 20.5312 45.7216 45.7216 45.7216H502.272c25.2416 0 45.7216-20.5312 45.7216-45.7216v-44.5952c-0.1024-60.1088-34.6112-112.2304-84.8896-137.728zM324.7616 409.2416c0-38.1952 31.0784-69.2224 69.2224-69.2224s69.2224 31.0784 69.2224 69.2224c0 37.7344-30.3616 68.4544-67.8912 69.1712-0.5632 0-1.1264-0.0512-1.6896-0.0512-0.4096 0-0.8192 0.0512-1.1776 0.0512-37.4784-0.8704-67.6864-31.488-67.6864-69.1712z m182.1696 268.032c0 2.6112-2.1504 4.7616-4.7616 4.7616h-217.088c-2.6112 0-4.7616-2.1504-4.7616-4.7616v-44.5952c0-62.1056 50.176-112.64 112.128-113.3056 0.512 0 1.024 0.1024 1.5872 0.1024 0.4608 0 0.8704-0.0512 1.3312-0.0512 61.696 0.9216 111.616 51.3536 111.616 113.3056v44.544zM795.2384 349.0304H599.04c-11.3152 0-20.48 9.1648-20.48 20.48s9.1648 20.48 20.48 20.48h196.1984c11.3152 0 20.48-9.1648 20.48-20.48s-9.1648-20.48-20.48-20.48zM795.2384 490.3424h-174.1312c-11.3152 0-20.48 9.1648-20.48 20.48s9.1648 20.48 20.48 20.48h174.1312c11.3152 0 20.48-9.1648 20.48-20.48s-9.1648-20.48-20.48-20.48zM795.2384 636.7744H653.312c-11.3152 0-20.48 9.1648-20.48 20.48s9.1648 20.48 20.48 20.48h141.9264a20.47488 20.47488 0 1 0 0-40.96z"
                                    fill="#2c2c2c" p-id="3521"></path></svg>
                            查看用户
                        </span>
                    </div>
                </a>
                <a href="/create_user/">
                    <div class="item" id="add_users">
                        <span>
                            <svg t="1645981052707" class="icon" viewBox="0 0 1024 1024" version="1.1"
                                 xmlns="http://www.w3.org/2000/svg" p-id="3272"
                                 width="200" height="200"><path
                                    d="M777.7792 142.1824H253.0816c-87.6544 0-158.976 71.3216-158.976 158.976v413.8496c0 87.6544 71.3216 158.976 158.976 158.976h524.6976c87.6544 0 159.0272-71.3216 159.0272-158.976V301.1584c-0.0512-87.6544-71.3728-158.976-159.0272-158.976z m-524.6976 40.96h524.6976c65.0752 0 118.0672 52.9408 118.0672 118.016v38.912H135.0144v-38.912c0-65.0752 52.992-118.016 118.0672-118.016z m524.6976 649.9328H253.0816c-65.0752 0-118.016-52.9408-118.016-118.016V381.0304h760.7808v334.0288c-0.0512 65.0752-52.992 118.016-118.0672 118.016z"
                                    fill="#2c2c2c" p-id="3273"></path><path
                                    d="M780.5952 675.8912h-175.2576c-11.3152 0-20.48 9.1648-20.48 20.48s9.1648 20.48 20.48 20.48h175.2576c11.3152 0 20.48-9.1648 20.48-20.48s-9.1648-20.48-20.48-20.48z"
                                    fill="#2c2c2c" p-id="3274"></path></svg>
                            添加用户
                        </span>
                    </div>
                </a>
            {% endif %}

            <a href="/me_info/{{ user.id }}">
                <div class="item" id="my_mess">
                    <span>
                         <svg t="1645980962587" class="icon" viewBox="0 0 1024 1024" version="1.1"
                              xmlns="http://www.w3.org/2000/svg" p-id="2723" width="200" height="200"><path
                                 d="M513.8432 460.8512c-89.4464 0-162.2016 72.7552-162.2016 162.2016s72.7552 162.2016 162.2016 162.2016 162.2016-72.7552 162.2016-162.2016-72.7552-162.2016-162.2016-162.2016z m0 283.4432c-66.8672 0-121.2416-54.3744-121.2416-121.2416s54.3744-121.2416 121.2416-121.2416 121.2416 54.3744 121.2416 121.2416-54.3744 121.2416-121.2416 121.2416z"
                                 fill="#2c2c2c" p-id="2724"></path><path
                                 d="M912.4864 140.9024c-9.6256-16.7936-26.9312-26.8288-46.336-26.8288h-212.0192c-19.3536 0-37.2224 10.496-46.6432 27.392l-75.8784 135.8848a341.92384 341.92384 0 0 0-34.56-0.0512l-75.776-135.8848c-9.4208-16.896-27.2896-27.392-46.6432-27.392H162.6112c-19.3536 0-36.6592 10.0352-46.336 26.8288-9.6256 16.7936-9.5744 36.8128 0.2048 53.504L242.0736 409.088c-46.4896 58.9312-74.3424 133.2224-74.3424 213.9648 0 190.8736 155.2896 346.1632 346.1632 346.1632s346.1632-155.2896 346.1632-346.1632c0-80.384-27.5968-154.368-73.728-213.1456l126.0032-215.4496c9.728-16.7424 9.7792-36.7616 0.1536-53.5552zM151.8592 161.28c1.0752-1.8944 4.3008-6.2464 10.8032-6.2464h212.0192c4.5056 0 8.6528 2.4576 10.8544 6.4l67.5328 120.9344C382.6688 294.912 319.5904 328.704 270.7456 376.9344L151.9104 173.7216c-3.2768-5.5808-1.1264-10.5984-0.0512-12.4416z m361.984 766.9248c-168.2944 0-305.2032-136.9088-305.2032-305.2032s136.9088-305.2032 305.2032-305.2032 305.2032 136.9088 305.2032 305.2032-136.9088 305.2032-305.2032 305.2032z m363.0592-754.4832l-119.1936 203.8784c-48.6912-48.384-111.7184-82.3296-182.016-95.0784l67.6352-121.1392c2.2016-3.9424 6.3488-6.4 10.8544-6.4h212.0192c6.5024 0 9.728 4.352 10.8032 6.2464s3.1744 6.912-0.1024 12.4928z"
                                 fill="#2c2c2c" p-id="2725"></path></svg>
                        个人信息
                    </span>
                </div>
            </a>

        </div>
    {% endblock left %}
</div>


<!-- 右侧内容 -->
<div id="right">
    {% block right %}
        <div class="block">
            <p>工单统计</p>
            <div>
                <p>总数量：{{ goods_info.all }}</p>
                <p>已完成：{{ goods_info.ok }}</p>
                <p>待完成：{{ goods_info.now }}</p>
                <p>今日新增：{{ goods_info.new }}</p>
                <p>延时处理：{{ goods_info.wait }}</p>
                <p>已超时：{{ goods_info.timeout }}</p>
            </div>
        </div>
        <div class="block">
            <p>用户统计</p>
            <div>
                <p>总用户：{{ user_info.all }}</p>
                <p>管理员：{{ user_info.super }}</p>
                <p>售后员：{{ user_info.shouhou }}</p>
                <p>申报员：{{ user_info.shenbao }}</p>
            </div>
        </div>

    {% endblock right %}
</div>

</body>
</html>
